<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AVI — Capacitaciones</title>
    <meta name="description" content="Capacitaciones de Audiovisual Intelligence" />
    <meta name="robots" content="noindex, nofollow" />
    <link rel="preload" as="style" href="assets/styles.css" />
    <link rel="stylesheet" href="assets/styles.css" />
    <script src="assets/gate.js"></script>
  </head>
  <body class="has-bg-video">
    <!-- Fondo de video global -->
    <video class="bg-video" autoplay muted loop playsinline aria-hidden="true">
      <source src="media/enter_0.mp4" type="video/mp4" />
    </video>
    <!-- Header -->
    <header class="site-header">
      <div class="container inner">
        <a class="brand" href="https://audiovisualintelligence.ai/" aria-label="Inicio">AVI</a>
        <nav class="nav" aria-label="Navegación principal">
          <a href="https://audiovisualintelligence.ai/capacitaciones.html" class="pill" aria-current="page">Capacitaciones</a>
          <a href="https://audiovisualintelligence.ai/quienes-somos.html" class="pill" title="Próximamente">Quienes somos</a>
          <a href="https://audiovisualintelligence.ai/contenidos.html" class="pill" title="Próximamente">Contenidos de estudio</a>
          <a href="https://audiovisualintelligence.ai/clientes.html" class="pill" title="Próximamente">Clientes</a>
          <a href="https://audiovisualintelligence.ai/id-lab.html" class="pill" title="Próximamente">I+D Lab</a>
        </nav>
      </div>
    </header>

    <!-- Hero con video de fondo -->
    <main>
      <section class="hero">
        <div class="container hero-content">
          <div class="eyebrow">Formación avanzada</div>
          <h1 class="title-xxl">Capacitaciones en IA Audiovisual</h1>
          <p class="subtitle">IA aplicada a desarrollo, pre, producción y post.</p>
          <div class="spacer-lg"></div>
        </div>
      </section>

      <!-- Grid cursos dinámico -->
      <section class="container">
        <div id="grid" class="grid"></div>
      </section>

      <div class="container">
        <div class="spacer-xl"></div>
        <p class="muted">¿Necesitas un plan a medida? <a class="accent" href="#">Escríbenos</a>.</p>
        <div class="spacer-xxl"></div>
      </div>
    </main>

    <footer class="site-footer">
      <div class="container">
        <div class="copyright">© <span id="y"></span> Audiovisual Intelligence</div>
      </div>
    </footer>

    <!-- Modal -->
    <dialog id="modal" class="modal">
      <div class="modal-backdrop" onclick="this.closest('dialog').close()"></div>
      <div class="modal-dialog">
        <div class="modal-hd">
          <div>
            <div id="m-nivel" class="badge"></div>
            <h3 id="m-titulo" style="margin:6px 0 0"></h3>
          </div>
          <button id="m-close" class="btn">Cerrar</button>
        </div>
        <div class="modal-bd">
          <div>
            <div class="kicker">Resumen</div>
            <p id="m-resumen" class="muted"></p>
            <div class="kicker" style="margin-top:12px">Objetivos</div>
            <ul id="m-objetivos" class="list"></ul>
            <div class="kicker" style="margin-top:12px">Temario</div>
            <ul id="m-temario" class="list"></ul>
          </div>
          <div>
            <div class="kicker">Duración y formato</div>
            <p id="m-duracion" class="muted"></p>
            <div class="kicker" style="margin-top:12px">Modalidad y horarios</div>
            <ul id="m-horarios" class="list"></ul>
            <div class="kicker" style="margin-top:12px">Incluye</div>
            <ul id="m-incluye" class="list"></ul>
            <div class="kicker" style="margin-top:12px">Requisitos</div>
            <p id="m-requisitos" class="muted"></p>
          </div>
        </div>
        <div class="modal-ft">
          <a id="m-mailto" class="btn" href="#">Solicitar información</a>
        </div>
      </div>
    </dialog>

    <script>
      // Año en footer
      document.getElementById('y').textContent = new Date().getFullYear();

      // Suavizar fondo al hacer scroll
      const softenOnScroll = () => {
        const y = window.scrollY || 0;
        if (y > 40) document.body.classList.add('bg-soften');
        else document.body.classList.remove('bg-soften');
      };
      softenOnScroll();
      window.addEventListener('scroll', softenOnScroll, { passive: true });

      // Scroll reveal (sin librerías)
      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (!prefersReduced && 'IntersectionObserver' in window) {
        const io = new IntersectionObserver((entries) => {
          for (const e of entries) if (e.isIntersecting) { e.target.classList.add('is-visible'); io.unobserve(e.target); }
        }, { rootMargin: '0px 0px -10% 0px', threshold: 0.1 });
        document.querySelectorAll('.reveal').forEach(el => io.observe(el));
      } else {
        document.querySelectorAll('.reveal').forEach(el => el.classList.add('is-visible'));
      }

      // Dinámica: cargar capacitaciones desde JSON
      const grid = document.getElementById('grid');
      function skeleton(n=3){
        grid.innerHTML='';
        for(let i=0;i<n;i++){
          const d=document.createElement('div');
          d.className='card';
          d.innerHTML=`<div class="card-media" style="background:linear-gradient(90deg,#111,#161616,#111);background-size:200% 100%;animation:sh 1.2s linear infinite"></div>
            <div class="card-body"><div class="card-title" style="opacity:.6">&nbsp;</div><span class="chip" style="opacity:.4">&nbsp;&nbsp;&nbsp;</span></div>`;
          grid.appendChild(d);
        }
      }
      skeleton();

      fetch('data/capacitaciones.json', {cache:'no-store'})
        .then(r=>r.json())
        .then(data=>{
          const items = (data.capacitaciones||[]).slice(0,3);
          grid.innerHTML='';
          for(const it of items){
            const a=document.createElement('a');
            a.href='#'; a.className='card reveal'; a.setAttribute('aria-label',`Abrir detalle ${it.titulo}`);
            const mediaHTML = `<div class="card-media" style="background:linear-gradient(135deg,#0f0f0f,#171717);"></div>`;
            a.innerHTML=`
              ${mediaHTML}
              <div class="card-body">
                <div class="card-title">${it.titulo}</div>
                <span class="chip">${it.duracion_total.split(' ')[0]} • ${it.nivel}</span>
              </div>`;
            a.addEventListener('click', (e)=>{ e.preventDefault(); openModal(it); });
            grid.appendChild(a);
          }
          if (!prefersReduced && 'IntersectionObserver' in window) {
            const io = new IntersectionObserver((entries) => {
              for (const e of entries) if (e.isIntersecting) { e.target.classList.add('is-visible'); io.unobserve(e.target); }
            }, { rootMargin: '0px 0px -10% 0px', threshold: 0.1 });
            document.querySelectorAll('.reveal').forEach(el => io.observe(el));
          } else {
            document.querySelectorAll('.reveal').forEach(el => el.classList.add('is-visible'));
          }
        })
        .catch(()=>{ grid.innerHTML='<p class="muted">No se pudo cargar el contenido.</p>'; });

      // Modal logic
      const modal = document.getElementById('modal');
      const mClose = document.getElementById('m-close');
      const mTitulo = document.getElementById('m-titulo');
      const mNivel = document.getElementById('m-nivel');
      const mResumen = document.getElementById('m-resumen');
      const mDuracion = document.getElementById('m-duracion');
      const mObjetivos = document.getElementById('m-objetivos');
      const mTemario = document.getElementById('m-temario');
      const mHorarios = document.getElementById('m-horarios');
      const mIncluye = document.getElementById('m-incluye');
      const mRequisitos = document.getElementById('m-requisitos');
      const mMail = document.getElementById('m-mailto');

      function listify(arr){ return (arr||[]).map(x=>`<li>${x}</li>`).join(''); }
      function openModal(it){
        mTitulo.textContent = it.titulo;
        mNivel.textContent = it.nivel;
        mResumen.textContent = it.resumen_corto||'';
        mDuracion.textContent = `${it.duracion_total || ''} · ${it.formato || ''}`;
        mObjetivos.innerHTML = listify(it.objetivos);
        mTemario.innerHTML = listify(it.temario_resumido);
        mHorarios.innerHTML = listify(it.modalidad_horarios);
        mIncluye.innerHTML = listify(it.incluye);
        mRequisitos.textContent = it.requisitos || '';
        const subject = encodeURIComponent(`Consulta — ${it.titulo}`);
        const body = encodeURIComponent(`Hola, quiero más información sobre "${it.titulo}".`);
        mMail.href = `mailto:avi.info.desk@gmail.com?subject=${subject}&body=${body}`;
        modal.showModal();
      }
      mClose?.addEventListener('click', ()=> modal.close());
    </script>
  </body>
  
</html>
