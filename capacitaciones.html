<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AVI — Capacitaciones</title>
    <meta name="description" content="Capacitaciones de Audiovisual Intelligence" />
    <meta name="robots" content="noindex, nofollow" />
    <link rel="preload" as="style" href="assets/styles.css" />
    <link rel="stylesheet" href="assets/styles.css" />
    <script src="assets/gate.js"></script>
  </head>
  <body class="has-bg-video">
    <!-- Fondo de video global -->
    <video class="bg-video" autoplay muted loop playsinline aria-hidden="true">
      <source src="media/enter_0.mp4" type="video/mp4" />
    </video>
    <!-- Header -->
    <header class="site-header">
      <div class="container inner">
        <a class="brand" href="https://audiovisualintelligence.ai/" aria-label="Inicio">AVI</a>
        <button class="hamburger" id="hamburger" aria-label="Abrir menú"><span></span></button>
      </div>
      <nav class="mobile-menu" id="mobileMenu" aria-label="Navegación principal" hidden>
        <ul class="menu-list">
          <li><a href="https://audiovisualintelligence.ai/capacitaciones.html" aria-current="page">Capacitaciones</a></li>
          <li><a href="https://audiovisualintelligence.ai/quienes-somos.html">Quienes somos</a></li>
          <li><a href="https://audiovisualintelligence.ai/contenidos.html">Contenidos de estudio</a></li>
          <li><a href="https://audiovisualintelligence.ai/clientes.html">Clientes</a></li>
          <li><a href="https://audiovisualintelligence.ai/id-lab.html">I+D Lab</a></li>
        </ul>
      </nav>
    </header>

    <!-- Hero con video de fondo -->
    <main>
      <section class="hero">
        <div class="container hero-content">
          <div class="eyebrow">Formación avanzada</div>
          <h1 class="title-xxl"><span class="avi-mark">I</span>nteligencia <span class="avi-mark">A</span>udiovisual</h1>
          <p class="subtitle">Capacitaciones en Inteligencia Artificial aplicada a la Industria Audiovisual</p>
          <div class="spacer-lg"></div>
          <div class="scroll-cta-hero">
            <button class="scroll-arrow scroll-arrow-xxl triple" aria-label="Ver"><svg viewBox="0 0 48 48" aria-hidden="true"><path class="line" d="M12 10 L24 22 L36 10"/><path class="line" d="M12 20 L24 32 L36 20"/><path class="line" d="M12 30 L24 42 L36 30"/></svg></button>
            <div class="scroll-label">VER</div>
          </div>
        </div>
      </section>

      <!-- Grid cursos dinámico -->
      <section class="container">
        <div class="spacer-scroll"></div>
        <!-- Paneles de cursos -->
        <div id="panels"></div>
      </section>

      <div class="container">
        <div class="spacer-xl"></div>
        <p class="muted">¿Necesitas un plan a medida? <a class="accent" href="#">Escríbenos</a>.</p>
        <div class="spacer-xxl"></div>
      </div>
    </main>

    <footer class="site-footer">
      <div class="container">
        <div class="copyright">© <span id="y"></span> Audiovisual Intelligence</div>
      </div>
    </footer>

    <!-- Modal -->
    <dialog id="modal" class="modal">
      <div class="modal-backdrop" onclick="this.closest('dialog').close()"></div>
      <div class="modal-dialog">
        <div class="modal-hd">
          <div>
            <div id="m-nivel" class="badge"></div>
            <h3 id="m-titulo" style="margin:6px 0 0"></h3>
          </div>
          <button id="m-close" class="btn">Cerrar</button>
        </div>
        <div class="modal-bd">
          <div>
            <div class="kicker">Resumen</div>
            <p id="m-resumen" class="muted"></p>
            <div class="kicker" style="margin-top:12px">Objetivos</div>
            <ul id="m-objetivos" class="list"></ul>
            <div class="kicker" style="margin-top:12px">Temario</div>
            <ul id="m-temario" class="list"></ul>
          </div>
          <div>
            <div class="kicker">Duración y formato</div>
            <p id="m-duracion" class="muted"></p>
            <div class="kicker" style="margin-top:12px">Modalidad y horarios</div>
            <ul id="m-horarios" class="list"></ul>
            <div class="kicker" style="margin-top:12px">Incluye</div>
            <ul id="m-incluye" class="list"></ul>
            <div class="kicker" style="margin-top:12px">Requisitos</div>
            <p id="m-requisitos" class="muted"></p>
          </div>
        </div>
        <div class="modal-ft">
          <a id="m-mailto" class="btn" href="#">Solicitar información</a>
        </div>
      </div>
    </dialog>

    <script>
      // Año en footer
      document.getElementById('y').textContent = new Date().getFullYear();

      // Suavizar fondo al hacer scroll
      const softenOnScroll = () => {
        const y = window.scrollY || 0;
        if (y > 40) document.body.classList.add('bg-soften');
        else document.body.classList.remove('bg-soften');
        // Pan del video de fondo: mapear scroll a object-position Y (0% → 100%)
        const docH = document.body.scrollHeight - window.innerHeight;
        const p = docH > 0 ? Math.min(Math.max(y / docH, 0), 1) : 0;
        const yPct = Math.round(p * 100);
        document.documentElement.style.setProperty('--bgY', `${yPct}%`);
      };
      softenOnScroll();
      window.addEventListener('scroll', softenOnScroll, { passive: true });

      // Scroll reveal (sin librerías)
      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (!prefersReduced && 'IntersectionObserver' in window) {
        const io = new IntersectionObserver((entries) => {
          for (const e of entries) if (e.isIntersecting) { e.target.classList.add('is-visible'); io.unobserve(e.target); }
        }, { rootMargin: '0px 0px -10% 0px', threshold: 0.1 });
        document.querySelectorAll('.reveal').forEach(el => io.observe(el));
      } else {
        document.querySelectorAll('.reveal').forEach(el => el.classList.add('is-visible'));
      }

      // Dinámica: cargar capacitaciones desde JSON
      const panels = document.getElementById('panels');

      fetch('data/capacitaciones.json', {cache:'no-store'})
        .then(r=>r.json())
        .then(data=>{
          const items = (data.capacitaciones||[]).slice(0,3);
          // Construir paneles tipo glass con contenido del JSON
          panels.innerHTML = items.map((it, i)=>{
            const objetivos = (it.objetivos||[]).map(x=>`<li>${x}</li>`).join('');
            const temario = (it.temario_resumido||[]).map(x=>`<li>${x}</li>`).join('');
            const horarios = (it.modalidad_horarios||[]).map(x=>`<li>${x}</li>`).join('');
            const incluye = (it.incluye||[]).map(x=>`<li>${x}</li>`).join('');
            return `
              <section class="between-panels">
                ${i===0?'<button class="scroll-arrow scroll-arrow-xxl" aria-label="Bajar">'+arrowSVG()+'</button>':''}
              </section>
              <section class="course-panel reveal" id="p${i}">
                <div class="hdr">
                  <div class="ttl">${it.titulo}</div>
                  <span class="meta">${it.horas_totales ? it.horas_totales : (it.duracion_total||'').split(' ')[0]} hs totales</span>
                </div>
                <div class="cols">
                  <div>
                    <div class="kicker">Resumen</div>
                    <p class="muted">${it.resumen_corto||''}</p>
                    <div class="kicker">Objetivos</div>
                    <ul class="list">${objetivos}</ul>
                  </div>
                  <div>
                    <div class="kicker">Temario</div>
                    <ul class="list">${temario}</ul>
                    <div class="kicker">Modalidad y horarios</div>
                    <ul class="list">${horarios}</ul>
                    <div class="kicker">Incluye</div>
                    <ul class="list">${incluye}</ul>
                  </div>
                </div>
              </section>
            `;
          }).join('') + `<section class="between-panels"><button class="scroll-arrow" aria-label="Bajar">${arrowSVG()}</button></section>`;

          // Click en flechas: scroll a siguiente bloque
          // Héroe: flecha VER hace scroll al primer panel
          document.querySelector('.scroll-cta-hero .scroll-arrow')?.addEventListener('click', ()=>{
            document.getElementById('p0')?.scrollIntoView({behavior:'smooth', block:'start'});
          });
          // Entre paneles: flechas hacen scroll al siguiente bloque
          panels.querySelectorAll('.scroll-arrow').forEach((b, idx)=>{
            b.addEventListener('click', ()=>{
              const next = panels.querySelector(`#p${idx}`) || panels.querySelector(`#p${idx-1}`);
              next?.scrollIntoView({behavior:'smooth', block:'start'});
            });
          });
          if (!prefersReduced && 'IntersectionObserver' in window) {
            const io = new IntersectionObserver((entries) => {
              for (const e of entries) if (e.isIntersecting) { e.target.classList.add('is-visible'); io.unobserve(e.target); }
            }, { rootMargin: '0px 0px -10% 0px', threshold: 0.1 });
            document.querySelectorAll('.reveal').forEach(el => io.observe(el));
          } else {
            document.querySelectorAll('.reveal').forEach(el => el.classList.add('is-visible'));
          }
        })
        .catch(()=>{ panels.innerHTML='<p class="muted">No se pudo cargar el contenido.</p>'; });

      // Utilidad: SVG de flecha
      function arrowSVG(){ return '<svg viewBox="0 0 48 48" aria-hidden="true"><path class="line" d="M8 16 L24 32 L40 16"/></svg>'; }
      function arrowTripleSVG(){ return '<svg viewBox="0 0 48 48" aria-hidden="true">\
        <path class="line" d="M12 10 L24 22 L36 10"/>\
        <path class="line" d="M12 20 L24 32 L36 20"/>\
        <path class="line" d="M12 30 L24 42 L36 30"/>\
      </svg>'; }
    </script>
  </body>
  
</html>
